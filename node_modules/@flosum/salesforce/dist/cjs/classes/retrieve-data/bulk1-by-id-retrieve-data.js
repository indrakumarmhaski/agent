'use strict';const _0x3d99d6=_0x5451;function _0x5451(_0x49cd67,_0x7cdef9){const _0x36b336=_0x36b3();return _0x5451=function(_0x5451a1,_0xf612ea){_0x5451a1=_0x5451a1-0x1ce;let _0x173f57=_0x36b336[_0x5451a1];return _0x173f57;},_0x5451(_0x49cd67,_0x7cdef9);}(function(_0x381738,_0x31c482){const _0x5862dd=_0x5451,_0x58a519=_0x381738();while(!![]){try{const _0x1acc52=parseInt(_0x5862dd(0x1f3))/0x1+-parseInt(_0x5862dd(0x213))/0x2+-parseInt(_0x5862dd(0x1e6))/0x3+-parseInt(_0x5862dd(0x231))/0x4*(parseInt(_0x5862dd(0x22f))/0x5)+-parseInt(_0x5862dd(0x203))/0x6*(-parseInt(_0x5862dd(0x216))/0x7)+parseInt(_0x5862dd(0x20b))/0x8+parseInt(_0x5862dd(0x22a))/0x9*(parseInt(_0x5862dd(0x22c))/0xa);if(_0x1acc52===_0x31c482)break;else _0x58a519['push'](_0x58a519['shift']());}catch(_0x4eb532){_0x58a519['push'](_0x58a519['shift']());}}}(_0x36b3,0x1caca));var __awaiter=this&&this[_0x3d99d6(0x201)]||function(_0x244c0f,_0x32f24e,_0x5f37e9,_0x1cfca8){function _0x51c74b(_0x475209){return _0x475209 instanceof _0x5f37e9?_0x475209:new _0x5f37e9(function(_0x137b06){_0x137b06(_0x475209);});}return new(_0x5f37e9||(_0x5f37e9=Promise))(function(_0x390f88,_0x42f3f8){const _0x29d143=_0x5451;function _0x32b8c4(_0x3e2dbc){const _0xe98e6=_0x5451;try{_0x2d2d9e(_0x1cfca8[_0xe98e6(0x227)](_0x3e2dbc));}catch(_0x586cce){_0x42f3f8(_0x586cce);}}function _0x47f4d4(_0x473520){try{_0x2d2d9e(_0x1cfca8['throw'](_0x473520));}catch(_0xb2e995){_0x42f3f8(_0xb2e995);}}function _0x2d2d9e(_0x1b1a65){const _0x409229=_0x5451;_0x1b1a65[_0x409229(0x21f)]?_0x390f88(_0x1b1a65['value']):_0x51c74b(_0x1b1a65['value'])[_0x409229(0x1f6)](_0x32b8c4,_0x47f4d4);}_0x2d2d9e((_0x1cfca8=_0x1cfca8[_0x29d143(0x206)](_0x244c0f,_0x32f24e||[]))[_0x29d143(0x227)]());});},__await=this&&this[_0x3d99d6(0x210)]||function(_0x3fd50e){return this instanceof __await?(this['v']=_0x3fd50e,this):new __await(_0x3fd50e);},__asyncGenerator=this&&this[_0x3d99d6(0x1e4)]||function(_0x2c599b,_0xc8b153,_0x30b52f){const _0x5690e0=_0x3d99d6;if(!Symbol[_0x5690e0(0x21b)])throw new TypeError(_0x5690e0(0x1ee));var _0xa25353=_0x30b52f[_0x5690e0(0x206)](_0x2c599b,_0xc8b153||[]),_0x51f02c,_0x4528b6=[];return _0x51f02c={},_0x2522f6(_0x5690e0(0x227)),_0x2522f6(_0x5690e0(0x233)),_0x2522f6(_0x5690e0(0x209)),_0x51f02c[Symbol[_0x5690e0(0x21b)]]=function(){return this;},_0x51f02c;function _0x2522f6(_0x2299fb){if(_0xa25353[_0x2299fb])_0x51f02c[_0x2299fb]=function(_0x577bd9){return new Promise(function(_0x2e6b9a,_0x5c215e){const _0xdd6921=_0x5451;_0x4528b6[_0xdd6921(0x222)]([_0x2299fb,_0x577bd9,_0x2e6b9a,_0x5c215e])>0x1||_0x53c456(_0x2299fb,_0x577bd9);});};}function _0x53c456(_0x2bb025,_0x3c6d00){try{_0x47f9d3(_0xa25353[_0x2bb025](_0x3c6d00));}catch(_0x5cf496){_0x2ed782(_0x4528b6[0x0][0x3],_0x5cf496);}}function _0x47f9d3(_0xf955d){const _0x1d1a40=_0x5690e0;_0xf955d[_0x1d1a40(0x218)]instanceof __await?Promise[_0x1d1a40(0x21a)](_0xf955d['value']['v'])[_0x1d1a40(0x1f6)](_0x125826,_0x42b835):_0x2ed782(_0x4528b6[0x0][0x2],_0xf955d);}function _0x125826(_0x19560d){_0x53c456('next',_0x19560d);}function _0x42b835(_0x1904d4){_0x53c456('throw',_0x1904d4);}function _0x2ed782(_0x2299cd,_0x49f3a0){const _0x413cba=_0x5690e0;if(_0x2299cd(_0x49f3a0),_0x4528b6[_0x413cba(0x1fa)](),_0x4528b6[_0x413cba(0x20f)])_0x53c456(_0x4528b6[0x0][0x0],_0x4528b6[0x0][0x1]);}},__importDefault=this&&this['__importDefault']||function(_0x2f1886){const _0x2850e2=_0x3d99d6;return _0x2f1886&&_0x2f1886[_0x2850e2(0x200)]?_0x2f1886:{'default':_0x2f1886};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const base_retrieve_data_1=__importDefault(require(_0x3d99d6(0x1e9))),enums_1=require('../../enums'),bulk1_service_1=__importDefault(require(_0x3d99d6(0x1de))),__1=require('..'),promises_1=require(_0x3d99d6(0x1e1)),utils_1=require(_0x3d99d6(0x1f2)),RETRIED_30_TIMES_ERROR='InternalServerError\x20:\x20Retried\x20more\x20than\x2030\x20times';function _0x36b3(){const _0x479338=['Object:\x20','execute','timers/promises','CSV','setTimeout','__asyncGenerator','Failed','625170bNYIAx','failedIds','getBatchInfo','./base-retrieve-data','join','.\x20Failed\x20record\x20ids:\x20','fetchBatchResult','\x20Close\x20Job','Symbol.asyncIterator\x20is\x20not\x20defined.','contentType','submittedBatchesById',',\x20batch:\x20','@flosum/utils','100195UtYQKb','logger','where','then','XML','state','createBatch','shift','Bulk1JobState','objectName','pop','api','TEXT_CSV','__esModule','__awaiter','isDone','274326pevAZS','\x20BulkJobId:\x20','build','apply','handleBatchResults','executeBatches','return','handleFailedIds','1244184YwVbTG','race','stream','createJob','length','__await','Bulk1JobContentType','closeJob','346228FzImjY','InProgress','Id\x20IN\x20(:ids)','7VGYJrb','queryBuilder','value','Batch\x20failed.\x20Job:\x20','resolve','asyncIterator','Bulk1BatchState','result','jobId','done','chunks','\x20Create\x20Job','push','pollInterval','maxParallelBatches','.\x0aState\x20messages:\x0a','Closed','next','abort','split','9daSefE','signal','2394650nLlOGJ','\x20Query:\x20','splitOnChunks','20975iCPndH','axiosConfig','40ELifZh','default','throw','batchResults','isAllBatchesSubmitted','jobOperation','chunkSize','handleFailedBatch','abortController','instance','ArrayUtils','setError','getResultsIterator','log','fetchBatchResultIds','resultBatch','completedBatches','error','submittedBatches','../../services/bulk1.service'];_0x36b3=function(){return _0x479338;};return _0x36b3();}class Bulk1ByIdRetrieveData extends base_retrieve_data_1['default']{constructor({objectName:_0x411b98,queryBuilder:_0x25d792,pollInterval:_0x2357c5,jobOperation:_0x3cfb3c,instance:_0x1d8704,chunkSize:_0x51c067,maxParallelBatches:_0x20c00f,contentType:_0x3bb569,ids:_0x42fa74,api:_0x32f67a,logger:_0x475a6e}){const _0x2770bd=_0x3d99d6;super(_0x1d8704,_0x25d792,_0x475a6e),this['error']=null,this[_0x2770bd(0x1db)]=[],this['failedIds']=[],this['isAllBatchesSubmitted']=![],this[_0x2770bd(0x1f0)]={},this[_0x2770bd(0x1d6)]=_0x41a576=>{const _0x45fc8b=_0x2770bd;!this[_0x45fc8b(0x1dc)]&&(this['error']=_0x41a576);},this[_0x2770bd(0x1fc)]=_0x411b98,this[_0x2770bd(0x223)]=_0x2357c5,this[_0x2770bd(0x1d0)]=_0x3cfb3c,this[_0x2770bd(0x1d1)]=_0x51c067,this[_0x2770bd(0x224)]=_0x20c00f,this[_0x2770bd(0x1ef)]=_0x3bb569,this[_0x2770bd(0x1fe)]=_0x32f67a,this[_0x2770bd(0x1d3)]=new AbortController(),this['axiosConfig']={'signal':this[_0x2770bd(0x1d3)][_0x2770bd(0x22b)]},this[_0x2770bd(0x220)]=utils_1[_0x2770bd(0x1d5)][_0x2770bd(0x22e)](_0x42fa74,this['chunkSize']),this[_0x2770bd(0x1ce)]=this['getResultsIterator']();}get[_0x3d99d6(0x1dd)](){return Object['values'](this['submittedBatchesById']);}[_0x3d99d6(0x1e0)](){var _0x179d67;return __awaiter(this,void 0x0,void 0x0,function*(){const _0xf189e4=_0x5451;try{const {done:_0x11b076,value:_0x2c5169}=yield this[_0xf189e4(0x1ce)][_0xf189e4(0x227)]();if(!_0x11b076)return _0x2c5169;if(this['failedIds'][_0xf189e4(0x20f)])return yield this['handleFailedIds']();return this[_0xf189e4(0x202)]=!![],yield this[_0xf189e4(0x212)](),null;}catch(_0x297e98){this[_0xf189e4(0x202)]=!![],yield this['closeJob'](),this[_0xf189e4(0x1d3)][_0xf189e4(0x228)]();throw(_0x179d67=this[_0xf189e4(0x1dc)])!==null&&_0x179d67!==void 0x0?_0x179d67:_0x297e98;}});}[_0x3d99d6(0x1d7)](){return __asyncGenerator(this,arguments,function*_0x1a291a(){const _0x667929=_0x5451;!this[_0x667929(0x21e)]&&(yield __await(this[_0x667929(0x20e)]()));do{!this[_0x667929(0x1cf)]&&(yield __await(this['executeBatches']()));while(this[_0x667929(0x1dd)][_0x667929(0x20f)]&&!this[_0x667929(0x1db)][_0x667929(0x20f)]){yield __await(Promise[_0x667929(0x20c)](this[_0x667929(0x1dd)]));}if(this[_0x667929(0x1dc)])throw this[_0x667929(0x1dc)];const {batchId:_0x3b6155,results:_0x315a51}=this[_0x667929(0x1db)]['pop']();for(const _0x5d981c of _0x315a51){yield yield __await(this[_0x667929(0x1ec)](_0x3b6155,_0x5d981c));}}while(this[_0x667929(0x1db)]['length']||this['submittedBatches'][_0x667929(0x20f)]);return yield __await(null);});}[_0x3d99d6(0x208)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x347ccf=_0x5451;while(this['submittedBatches']['length']<this[_0x347ccf(0x224)]){if(this[_0x347ccf(0x1dc)])throw this[_0x347ccf(0x1dc)];const _0x6d0a66=this['chunks'][_0x347ccf(0x1fd)]();if(!_0x6d0a66){this['isAllBatchesSubmitted']=!![];return;}const _0x1b399c=yield this[_0x347ccf(0x1f9)](_0x6d0a66);this[_0x347ccf(0x1f0)][_0x1b399c]=this[_0x347ccf(0x207)](_0x1b399c,_0x6d0a66)['catch'](this[_0x347ccf(0x1d6)]);}});}[_0x3d99d6(0x207)](_0x1ba495,_0x1185c4){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2d7919=_0x5451,{state:_0x58777f,stateMessage:_0x2d6fe8}=yield this['waitForBatchCompletion'](_0x1ba495);if(_0x58777f===enums_1[_0x2d7919(0x21c)][_0x2d7919(0x1e5)])this[_0x2d7919(0x1d2)](_0x1ba495,_0x1185c4,_0x2d6fe8);else{const _0x3d52ed=yield this['fetchBatchResultIds'](_0x1ba495);this['completedBatches']['push']({'batchId':_0x1ba495,'results':_0x3d52ed});}delete this[_0x2d7919(0x1f0)][_0x1ba495];});}[_0x3d99d6(0x1d2)](_0x26f90d,_0x51d819,_0x480d73){const _0x24ba65=_0x3d99d6,_0x2a74e5=_0x480d73[_0x24ba65(0x229)](';');if(_0x2a74e5['at'](0x0)===RETRIED_30_TIMES_ERROR){this[_0x24ba65(0x1e7)]['push'](..._0x51d819);return;}throw new Error(_0x24ba65(0x219)+this[_0x24ba65(0x21e)]+_0x24ba65(0x1f1)+_0x26f90d+_0x24ba65(0x225)+_0x480d73);}[_0x3d99d6(0x20a)](){const _0x3917e0=_0x3d99d6;this[_0x3917e0(0x1d1)]=Math['trunc'](this['chunkSize']/0x2);if(this[_0x3917e0(0x1d1)]===0x0)throw new Error('Minimal\x20chunk\x20size\x20reached.\x20Job\x20id:\x20'+this['jobId']+_0x3917e0(0x1eb)+this[_0x3917e0(0x1e7)][_0x3917e0(0x1ea)](','));return this[_0x3917e0(0x220)]=utils_1[_0x3917e0(0x1d5)]['splitOnChunks'](this['failedIds'],this[_0x3917e0(0x1d1)]),this[_0x3917e0(0x1e7)]['length']=0x0,this[_0x3917e0(0x1cf)]=![],this[_0x3917e0(0x1ce)]=this[_0x3917e0(0x1d7)](),this[_0x3917e0(0x1e0)]();}[_0x3d99d6(0x20e)](){var _0xe73cd9;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x42c47b=_0x5451,_0x451d3e=this[_0x42c47b(0x1ef)]===enums_1['BulkV1QueryContentType'][_0x42c47b(0x1ff)]?enums_1[_0x42c47b(0x211)][_0x42c47b(0x1e2)]:enums_1[_0x42c47b(0x211)][_0x42c47b(0x1f7)],_0x13a676={'object':this[_0x42c47b(0x1fc)],'contentType':_0x451d3e,'operation':this[_0x42c47b(0x1d0)]},{id:_0x2fb8fc}=yield bulk1_service_1['default'][_0x42c47b(0x20e)](this[_0x42c47b(0x1d4)],_0x13a676,{},this['api']);this[_0x42c47b(0x21e)]=_0x2fb8fc,(_0xe73cd9=this[_0x42c47b(0x1f4)])===null||_0xe73cd9===void 0x0?void 0x0:_0xe73cd9[_0x42c47b(0x1d8)](_0x42c47b(0x1df)+this[_0x42c47b(0x1fc)]+_0x42c47b(0x204)+this['jobId']+_0x42c47b(0x221));});}['createBatch'](_0x332c72){var _0x4a088e;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x17f7c9=_0x5451,_0x2d29ce=new __1['ClauseBuilder']()[_0x17f7c9(0x1f5)](_0x17f7c9(0x215),{'ids':_0x332c72}),_0x61f462=this[_0x17f7c9(0x217)]['copy']()['where'](_0x2d29ce)[_0x17f7c9(0x205)]();(_0x4a088e=this['logger'])===null||_0x4a088e===void 0x0?void 0x0:_0x4a088e[_0x17f7c9(0x1d8)](_0x17f7c9(0x1df)+this[_0x17f7c9(0x1fc)]+_0x17f7c9(0x204)+this[_0x17f7c9(0x21e)]+_0x17f7c9(0x22d)+_0x61f462);const {id:_0x1ed79f}=yield bulk1_service_1[_0x17f7c9(0x232)][_0x17f7c9(0x1f9)](this[_0x17f7c9(0x1d4)],_0x61f462,{'headers':{'Content-Type':this[_0x17f7c9(0x1ef)]},'signal':this['abortController'][_0x17f7c9(0x22b)]},this[_0x17f7c9(0x21e)],this[_0x17f7c9(0x1fe)]);return _0x1ed79f;});}['waitForBatchCompletion'](_0x184a29){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x559b9f=_0x5451;let _0x1a2a65;do{yield(0x0,promises_1[_0x559b9f(0x1e3)])(this[_0x559b9f(0x223)]),_0x1a2a65=yield bulk1_service_1['default'][_0x559b9f(0x1e8)](this[_0x559b9f(0x1d4)],this['axiosConfig'],this[_0x559b9f(0x21e)],_0x184a29,this[_0x559b9f(0x1fe)]);}while(_0x1a2a65[_0x559b9f(0x1f8)]===enums_1[_0x559b9f(0x21c)][_0x559b9f(0x214)]||_0x1a2a65[_0x559b9f(0x1f8)]===enums_1['Bulk1BatchState']['Queued']);return _0x1a2a65;});}[_0x3d99d6(0x1d9)](_0xb6e1dc){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3e936e=_0x5451,_0x4b61e5=yield bulk1_service_1[_0x3e936e(0x232)][_0x3e936e(0x1da)](this[_0x3e936e(0x1d4)],this['axiosConfig'],this[_0x3e936e(0x21e)],_0xb6e1dc,this[_0x3e936e(0x1fe)]);return _0x4b61e5;});}[_0x3d99d6(0x1ec)](_0x166a37,_0x52fd3c){const _0x276550=_0x3d99d6;return bulk1_service_1[_0x276550(0x232)][_0x276550(0x21d)](this[_0x276550(0x1d4)],{'responseType':_0x276550(0x20d),'signal':this[_0x276550(0x230)][_0x276550(0x22b)]},this[_0x276550(0x21e)],_0x166a37,_0x52fd3c,this[_0x276550(0x1fe)]);}[_0x3d99d6(0x212)](){var _0x2b3046;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2aeff5=_0x5451;if(!this[_0x2aeff5(0x21e)])return;yield bulk1_service_1[_0x2aeff5(0x232)][_0x2aeff5(0x212)](this[_0x2aeff5(0x1d4)],{},{'state':enums_1[_0x2aeff5(0x1fb)][_0x2aeff5(0x226)]},this[_0x2aeff5(0x21e)],this[_0x2aeff5(0x1fe)]),(_0x2b3046=this[_0x2aeff5(0x1f4)])===null||_0x2b3046===void 0x0?void 0x0:_0x2b3046[_0x2aeff5(0x1d8)](_0x2aeff5(0x1df)+this[_0x2aeff5(0x1fc)]+'\x20BulkJobId:\x20'+this[_0x2aeff5(0x21e)]+_0x2aeff5(0x1ed)),this[_0x2aeff5(0x21e)]=null;});}}exports['default']=Bulk1ByIdRetrieveData;