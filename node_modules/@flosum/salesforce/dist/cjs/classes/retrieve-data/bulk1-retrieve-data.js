'use strict';function _0x1c50(){const _0x40572d=['sort','1443197xafRBo','setTimeout','2200176PBcUUR','_jobOperation','isExecutable','getResultIds','1VEpBmj','\x20Create\x20Job','logger','batchId','done','createJob','numberRecordsProcessed','stream','resultBatch','974583llubtc','Bulk1JobContentType','default','8176jpWMqu','__importDefault','batchResultIds','../../constants','requestConfig','Object:\x20','../../enums/bulk1.enums','defineProperty','../../constants/bulk.constants','__esModule','getBatchInfo','5MgzMCf','instance','Bulk1BatchState','JOB_WAITING_LIMIT_MESSAGE','length','api','next','execute','then','Query','copy','./base-retrieve-data','7835600pVCGqC','Closed','419072okoBQn','pollInterval','value','closeJob','CSV','__awaiter','WAITING_LIMIT_FOR_JOB','result','getTime','SalesforceConstants','jobId','InProgress','BulkV1QueryContentType','Queued','6BhjhUE','\x20BulkJobId:\x20','query','774178aQoxxz','../salesforce-error.class','waitCompletionBaseBatch','log','objectName','createBatch','\x20Query:\x20','queryBuilder','../../utils/test.utils','isDone','Failed','Bulk1JobOperation','XML','throw'];_0x1c50=function(){return _0x40572d;};return _0x1c50();}const _0x3f8377=_0x2fd3;(function(_0x5667e8,_0x2d64b2){const _0x1b1369=_0x2fd3,_0x5f486d=_0x5667e8();while(!![]){try{const _0x3c6484=-parseInt(_0x1b1369(0x119))/0x1*(parseInt(_0x1b1369(0x14f))/0x2)+-parseInt(_0x1b1369(0x122))/0x3+-parseInt(_0x1b1369(0x13e))/0x4*(-parseInt(_0x1b1369(0x130))/0x5)+parseInt(_0x1b1369(0x14c))/0x6*(-parseInt(_0x1b1369(0x113))/0x7)+parseInt(_0x1b1369(0x125))/0x8+parseInt(_0x1b1369(0x115))/0x9+parseInt(_0x1b1369(0x13c))/0xa;if(_0x3c6484===_0x2d64b2)break;else _0x5f486d['push'](_0x5f486d['shift']());}catch(_0x533438){_0x5f486d['push'](_0x5f486d['shift']());}}}(_0x1c50,0x34a8d));var __awaiter=this&&this[_0x3f8377(0x143)]||function(_0x4fee59,_0x5ba77a,_0x16200f,_0x21ea71){function _0xd6461e(_0x5d6658){return _0x5d6658 instanceof _0x16200f?_0x5d6658:new _0x16200f(function(_0x51cb91){_0x51cb91(_0x5d6658);});}return new(_0x16200f||(_0x16200f=Promise))(function(_0x1e31ef,_0x28f638){const _0x16ad5c=_0x2fd3;function _0x19c7db(_0x2e1221){const _0x233b13=_0x2fd3;try{_0x4eb982(_0x21ea71[_0x233b13(0x136)](_0x2e1221));}catch(_0x248602){_0x28f638(_0x248602);}}function _0x5f3198(_0x1949b8){const _0xdbf9a5=_0x2fd3;try{_0x4eb982(_0x21ea71[_0xdbf9a5(0x111)](_0x1949b8));}catch(_0x2c445a){_0x28f638(_0x2c445a);}}function _0x4eb982(_0x28d32a){const _0x4c6192=_0x2fd3;_0x28d32a[_0x4c6192(0x11d)]?_0x1e31ef(_0x28d32a['value']):_0xd6461e(_0x28d32a[_0x4c6192(0x140)])[_0x4c6192(0x138)](_0x19c7db,_0x5f3198);}_0x4eb982((_0x21ea71=_0x21ea71['apply'](_0x4fee59,_0x5ba77a||[]))[_0x16ad5c(0x136)]());});},__importDefault=this&&this[_0x3f8377(0x126)]||function(_0x19d58c){const _0x391f83=_0x3f8377;return _0x19d58c&&_0x19d58c[_0x391f83(0x12e)]?_0x19d58c:{'default':_0x19d58c};};Object[_0x3f8377(0x12c)](exports,'__esModule',{'value':!![]});function _0x2fd3(_0x1766d8,_0x853627){const _0x1c5041=_0x1c50();return _0x2fd3=function(_0x2fd3dd,_0x15ec5e){_0x2fd3dd=_0x2fd3dd-0x108;let _0x112a1f=_0x1c5041[_0x2fd3dd];return _0x112a1f;},_0x2fd3(_0x1766d8,_0x853627);}const base_retrieve_data_1=__importDefault(require(_0x3f8377(0x13b))),bulk1_service_1=__importDefault(require('../../services/bulk1.service')),bulk_constants_1=__importDefault(require(_0x3f8377(0x12d))),bulk1_enums_1=require(_0x3f8377(0x12b)),promises_1=require('timers/promises'),test_utils_1=__importDefault(require(_0x3f8377(0x10c))),salesforce_error_class_1=__importDefault(require(_0x3f8377(0x150))),constants_1=require(_0x3f8377(0x128));class Bulk1RetrieveData extends base_retrieve_data_1['default']{constructor({instance:_0xc88c8e,api:_0x350850,pollInterval:_0x3c478e,queryBuilder:_0x20c09c,objectName:_0x18af8f,contentType:_0x2fb14f,jobOperation:jobOperation=bulk1_enums_1[_0x3f8377(0x10f)][_0x3f8377(0x139)],logger:_0x5f5a84}){const _0x4e8872=_0x3f8377;super(_0xc88c8e,_0x20c09c,_0x5f5a84),this['objectName']=_0x18af8f,this[_0x4e8872(0x13f)]=_0x3c478e,this[_0x4e8872(0x135)]=_0x350850,this['contentType']=_0x2fb14f,this['_jobOperation']=jobOperation;}get['requestConfig'](){const _0x1cbbf4=_0x3f8377;return{'responseType':_0x1cbbf4(0x120)};}get[_0x3f8377(0x14e)](){const _0xd21dec=_0x3f8377;return this[_0xd21dec(0x10b)][_0xd21dec(0x13a)]()['build'](![]);}[_0x3f8377(0x137)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4c069b=_0x2fd3;this[_0x4c069b(0x117)]();try{if(!this[_0x4c069b(0x148)]){yield this[_0x4c069b(0x11e)]()['then'](()=>this[_0x4c069b(0x109)]())[_0x4c069b(0x138)](()=>this[_0x4c069b(0x151)]());if(!this['numberRecordsProcessed'])return this[_0x4c069b(0x10d)]=!![],yield this['closeJob'](),null;yield this[_0x4c069b(0x118)]();}const _0x242b67=this[_0x4c069b(0x127)]['shift'](),_0x24b0c4=yield bulk1_service_1['default'][_0x4c069b(0x145)](this[_0x4c069b(0x131)],this[_0x4c069b(0x129)],this[_0x4c069b(0x148)],this['batchId'],_0x242b67,this[_0x4c069b(0x135)]);return!this[_0x4c069b(0x127)][_0x4c069b(0x134)]&&(this['isDone']=!![],yield this[_0x4c069b(0x141)]()),_0x24b0c4;}catch(_0x105448){this['isDone']=!![],yield this[_0x4c069b(0x141)]();throw _0x105448;}});}['closeJob'](){var _0x130958;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x460b55=_0x2fd3;if(!this[_0x460b55(0x148)])return;yield bulk1_service_1[_0x460b55(0x124)]['closeJob'](this[_0x460b55(0x131)],{},{'state':bulk1_enums_1['Bulk1JobState'][_0x460b55(0x13d)]},this[_0x460b55(0x148)],this[_0x460b55(0x135)]),(_0x130958=this[_0x460b55(0x11b)])===null||_0x130958===void 0x0?void 0x0:_0x130958[_0x460b55(0x152)](_0x460b55(0x12a)+this[_0x460b55(0x108)]+_0x460b55(0x14d)+this[_0x460b55(0x148)]+'\x20Close\x20Job'),this['jobId']=null;});}[_0x3f8377(0x118)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x35307f=_0x2fd3;this[_0x35307f(0x127)]=yield bulk1_service_1['default'][_0x35307f(0x121)](this['instance'],{},this[_0x35307f(0x148)],this[_0x35307f(0x11c)],this[_0x35307f(0x135)])[_0x35307f(0x138)](_0x549c1b=>_0x549c1b[_0x35307f(0x112)]());});}[_0x3f8377(0x109)](){var _0x43fa72;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2b9b57=_0x2fd3;(_0x43fa72=this['logger'])===null||_0x43fa72===void 0x0?void 0x0:_0x43fa72[_0x2b9b57(0x152)]('Object:\x20'+this['objectName']+_0x2b9b57(0x14d)+this[_0x2b9b57(0x148)]+_0x2b9b57(0x10a)+this[_0x2b9b57(0x14e)]);const {id:_0x2ac6e5}=yield bulk1_service_1[_0x2b9b57(0x124)][_0x2b9b57(0x109)](this['instance'],this[_0x2b9b57(0x14e)],{'headers':{'Content-Type':this['contentType']}},this[_0x2b9b57(0x148)],this[_0x2b9b57(0x135)]);this[_0x2b9b57(0x11c)]=_0x2ac6e5;});}[_0x3f8377(0x151)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5e3ce9=_0x2fd3,{numberRecordsProcessed:_0x1fdf79,createdDate:_0x262890,state:_0x341011,stateMessage:_0x3a6169}=yield bulk1_service_1[_0x5e3ce9(0x124)][_0x5e3ce9(0x12f)](this[_0x5e3ce9(0x131)],{},this[_0x5e3ce9(0x148)],this[_0x5e3ce9(0x11c)],this['api']);if(new Date()[_0x5e3ce9(0x146)]()-new Date(_0x262890)[_0x5e3ce9(0x146)]()>bulk_constants_1[_0x5e3ce9(0x124)][_0x5e3ce9(0x144)]&&_0x1fdf79===0x0){yield this[_0x5e3ce9(0x141)]();throw new salesforce_error_class_1[(_0x5e3ce9(0x124))](constants_1[_0x5e3ce9(0x147)][_0x5e3ce9(0x133)],constants_1['SalesforceConstants']['JOB_WAITING_LIMIT_CODE']);}this[_0x5e3ce9(0x11f)]=_0x1fdf79;switch(_0x341011){case bulk1_enums_1[_0x5e3ce9(0x132)][_0x5e3ce9(0x149)]:case bulk1_enums_1[_0x5e3ce9(0x132)][_0x5e3ce9(0x14b)]:!test_utils_1['default']['isTest']()&&(yield(0x0,promises_1[_0x5e3ce9(0x114)])(this['pollInterval']));return this[_0x5e3ce9(0x151)]();case bulk1_enums_1[_0x5e3ce9(0x132)][_0x5e3ce9(0x10e)]:throw new salesforce_error_class_1['default'](_0x3a6169);}});}['createJob'](){var _0x2289ab;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5f1c66=_0x2fd3,_0x1fdaf0=this['contentType']===bulk1_enums_1[_0x5f1c66(0x14a)]['TEXT_CSV']?bulk1_enums_1[_0x5f1c66(0x123)][_0x5f1c66(0x142)]:bulk1_enums_1[_0x5f1c66(0x123)][_0x5f1c66(0x110)],_0x448b78={'object':this[_0x5f1c66(0x108)],'contentType':_0x1fdaf0,'operation':this[_0x5f1c66(0x116)]},_0x55c59c={},{id:_0x14a35b}=yield bulk1_service_1['default'][_0x5f1c66(0x11e)](this['instance'],_0x448b78,_0x55c59c,this[_0x5f1c66(0x135)]);this[_0x5f1c66(0x148)]=_0x14a35b,(_0x2289ab=this['logger'])===null||_0x2289ab===void 0x0?void 0x0:_0x2289ab[_0x5f1c66(0x152)]('Object:\x20'+this['objectName']+'\x20BulkJobId:\x20'+this[_0x5f1c66(0x148)]+_0x5f1c66(0x11a));});}}exports[_0x3f8377(0x124)]=Bulk1RetrieveData;