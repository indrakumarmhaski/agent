'use strict';const _0x2e47c0=_0x2607;(function(_0x14602f,_0x1d15fe){const _0x31ec34=_0x2607,_0x4aff8c=_0x14602f();while(!![]){try{const _0x50f5b7=-parseInt(_0x31ec34(0xff))/0x1+parseInt(_0x31ec34(0x122))/0x2*(parseInt(_0x31ec34(0x111))/0x3)+parseInt(_0x31ec34(0xf9))/0x4+parseInt(_0x31ec34(0xf8))/0x5*(-parseInt(_0x31ec34(0xed))/0x6)+-parseInt(_0x31ec34(0xfe))/0x7*(-parseInt(_0x31ec34(0x11b))/0x8)+parseInt(_0x31ec34(0xeb))/0x9*(parseInt(_0x31ec34(0x116))/0xa)+-parseInt(_0x31ec34(0x127))/0xb;if(_0x50f5b7===_0x1d15fe)break;else _0x4aff8c['push'](_0x4aff8c['shift']());}catch(_0x5f4956){_0x4aff8c['push'](_0x4aff8c['shift']());}}}(_0x33af,0x725bd));function _0x33af(){const _0x26ac85=['state','updateBatchesDetail','execute','Completed','getAllBatchesDetail','setTimeout','Bulk1JobContentType','waitCompletionBaseBatch','chunkSize','timers/promises','queryBuilder','../../enums/bulk1.enums','resultBatch','Bulk1JobState','updateCurrentBatchId','455556nzNLin','getAllBatchInfo','value','getTime','TEXT_CSV','10PBncjX','pollInterval','getBatchInfo','Failed','\x20BulkJobId:\x20','40otUKfK','../../services/bulk1.service','../../utils/test.utils','createBatch','instance','then','__awaiter','2auBdnz','isTest','__importDefault','currentBatchId','Query','9288389YAqQTD','init','requestConfig','build','\x20Close\x20Job','CSV','BulkV1QueryContentType','batchResultIds','lastUpdateBatchesDetail','jobId','closeJob','shift','api','Bulk1JobOperation','log','length','_jobOperation','updateBatchResultIds','throw','stream','stateMessage','splice','next','\x20Create\x20Job','3988638QerFpg','done','60lNcdhe','map','getBatchResult','objectName','Object:\x20','default','filter','logger','batchesDetail','contentType','createJob','258365GZeboe','2782768utFEQW','Bulk1BatchState','__esModule','baseBatchId','\x20Query:\x20','803481nZlqHU','35099AemWdS','Queued','defineProperty'];_0x33af=function(){return _0x26ac85;};return _0x33af();}var __awaiter=this&&this[_0x2e47c0(0x121)]||function(_0x3f0a76,_0x4f255e,_0x4c60a4,_0x1fc3d3){function _0x23f33a(_0x7d236b){return _0x7d236b instanceof _0x4c60a4?_0x7d236b:new _0x4c60a4(function(_0x1e6381){_0x1e6381(_0x7d236b);});}return new(_0x4c60a4||(_0x4c60a4=Promise))(function(_0x22f2f9,_0x2c84cd){const _0x589961=_0x2607;function _0x4c322a(_0x2f78b0){const _0x1bddf1=_0x2607;try{_0x3de115(_0x1fc3d3[_0x1bddf1(0xe9)](_0x2f78b0));}catch(_0x8e8010){_0x2c84cd(_0x8e8010);}}function _0x273c7c(_0x9e6278){const _0x4fd014=_0x2607;try{_0x3de115(_0x1fc3d3[_0x4fd014(0xe5)](_0x9e6278));}catch(_0x3df779){_0x2c84cd(_0x3df779);}}function _0x3de115(_0x43b926){const _0x1f5c45=_0x2607;_0x43b926[_0x1f5c45(0xec)]?_0x22f2f9(_0x43b926[_0x1f5c45(0x113)]):_0x23f33a(_0x43b926['value'])[_0x1f5c45(0x120)](_0x4c322a,_0x273c7c);}_0x3de115((_0x1fc3d3=_0x1fc3d3['apply'](_0x3f0a76,_0x4f255e||[]))[_0x589961(0xe9)]());});},__importDefault=this&&this[_0x2e47c0(0x124)]||function(_0x21a88f){const _0x4e5a62=_0x2e47c0;return _0x21a88f&&_0x21a88f[_0x4e5a62(0xfb)]?_0x21a88f:{'default':_0x21a88f};};Object[_0x2e47c0(0x101)](exports,_0x2e47c0(0xfb),{'value':!![]});const base_retrieve_data_1=__importDefault(require('./base-retrieve-data')),bulk1_service_1=__importDefault(require(_0x2e47c0(0x11c))),bulk1_enums_1=require(_0x2e47c0(0x10d)),promises_1=require(_0x2e47c0(0x10b)),test_utils_1=__importDefault(require(_0x2e47c0(0x11d))),salesforce_error_class_1=__importDefault(require('../salesforce-error.class'));class Bulk1PkRetrieveData extends base_retrieve_data_1[_0x2e47c0(0xf2)]{constructor({instance:_0xc8fbd1,api:_0x41fb87,pollInterval:_0x47e357,queryBuilder:_0x164e5e,objectName:_0x4e7bc4,contentType:_0x5ed4d0,chunkSize:_0xa7bbe6,jobOperation:jobOperation=bulk1_enums_1[_0x2e47c0(0xe0)][_0x2e47c0(0x126)],logger:_0x4f3907}){const _0x30aca2=_0x2e47c0;super(_0xc8fbd1,_0x164e5e,_0x4f3907),this['batchResultIds']=[],this['objectName']=_0x4e7bc4,this[_0x30aca2(0x117)]=_0x47e357,this[_0x30aca2(0xf6)]=_0x5ed4d0,this[_0x30aca2(0x10a)]=_0xa7bbe6,this['api']=_0x41fb87,this[_0x30aca2(0xe3)]=jobOperation;}get[_0x2e47c0(0x129)](){const _0x2b49ad=_0x2e47c0;return{'responseType':_0x2b49ad(0xe6)};}['execute'](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2bac5d=_0x2607;this['isExecutable']();try{!this[_0x2bac5d(0xdc)]&&(yield this[_0x2bac5d(0x128)]());if(!this[_0x2bac5d(0xf5)][_0x2bac5d(0xe2)]&&!this['batchResultIds'][_0x2bac5d(0xe2)])return this['isDone']=!![],yield this[_0x2bac5d(0xdd)](),null;!this[_0x2bac5d(0xda)][_0x2bac5d(0xe2)]&&(yield this[_0x2bac5d(0x110)](),yield this[_0x2bac5d(0xe4)]());if(!this[_0x2bac5d(0xda)][_0x2bac5d(0xe2)])return yield this[_0x2bac5d(0x104)]();const _0x772d1b=this[_0x2bac5d(0xda)][_0x2bac5d(0xde)]();return yield this[_0x2bac5d(0xef)](_0x772d1b);}catch(_0x290785){this['isDone']=!![],yield this[_0x2bac5d(0xdd)]();throw _0x290785;}});}[_0x2e47c0(0xdd)](){var _0x2898ea;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5b7ba8=_0x2607;if(!this[_0x5b7ba8(0xdc)])return;yield bulk1_service_1[_0x5b7ba8(0xf2)][_0x5b7ba8(0xdd)](this[_0x5b7ba8(0x11f)],{},{'state':bulk1_enums_1[_0x5b7ba8(0x10f)]['Closed']},this[_0x5b7ba8(0xdc)],this[_0x5b7ba8(0xdf)]),(_0x2898ea=this[_0x5b7ba8(0xf4)])===null||_0x2898ea===void 0x0?void 0x0:_0x2898ea[_0x5b7ba8(0xe1)](_0x5b7ba8(0xf1)+this[_0x5b7ba8(0xf0)]+'\x20BulkJobId:\x20'+this[_0x5b7ba8(0xdc)]+_0x5b7ba8(0xd7)),this['jobId']=null;});}[_0x2e47c0(0x110)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x49b1af=_0x2607;if(!this[_0x49b1af(0xf5)]['length']){this[_0x49b1af(0x125)]=null;return;}for(let _0x27ae83=0x0;_0x27ae83<this[_0x49b1af(0xf5)]['length'];_0x27ae83++){const {state:_0xd3f9c9,stateMessage:_0xb97f0c}=this[_0x49b1af(0xf5)][_0x27ae83];if(_0xd3f9c9===bulk1_enums_1['Bulk1BatchState'][_0x49b1af(0x119)])throw new salesforce_error_class_1[(_0x49b1af(0xf2))](_0xb97f0c);if(_0xd3f9c9===bulk1_enums_1[_0x49b1af(0xfa)][_0x49b1af(0x105)]){const [{id:_0x23cf09}]=this[_0x49b1af(0xf5)][_0x49b1af(0xe8)](_0x27ae83,0x1);this[_0x49b1af(0x125)]=_0x23cf09;return;}}if(!test_utils_1[_0x49b1af(0xf2)][_0x49b1af(0x123)]()){const _0x26c01c=new Date()['getTime']()-this[_0x49b1af(0xdb)];yield(0x0,promises_1[_0x49b1af(0x107)])(_0x26c01c>=this[_0x49b1af(0x117)]?0x0:this[_0x49b1af(0x117)]-_0x26c01c);}return yield this[_0x49b1af(0x103)](),this[_0x49b1af(0x110)]();});}['updateBatchesDetail'](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x115ad2=_0x2607,_0x12efbb=yield bulk1_service_1[_0x115ad2(0xf2)]['getAllBatchInfo'](this['instance'],{},this[_0x115ad2(0xdc)],this[_0x115ad2(0xdf)]);for(const _0x286e79 of this[_0x115ad2(0xf5)]){const _0x45b0c1=_0x12efbb['find'](({id:_0x14b90e})=>_0x14b90e===_0x286e79['id']);_0x286e79[_0x115ad2(0xe7)]=_0x45b0c1['stateMessage'],_0x286e79[_0x115ad2(0x102)]=_0x45b0c1[_0x115ad2(0x102)];}this[_0x115ad2(0xdb)]=new Date()[_0x115ad2(0x114)]();});}['updateBatchResultIds'](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5f3533=_0x2607,_0x2b1368=yield bulk1_service_1['default'][_0x5f3533(0x10e)](this[_0x5f3533(0x11f)],{},this[_0x5f3533(0xdc)],this['currentBatchId'],this[_0x5f3533(0xdf)]);this['batchResultIds']=_0x2b1368;});}[_0x2e47c0(0x128)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x24be61=_0x2607;yield this[_0x24be61(0xf7)](),yield this[_0x24be61(0x11e)](),yield this[_0x24be61(0x109)](),yield this[_0x24be61(0x106)]();});}[_0x2e47c0(0x11e)](){var _0x30d036;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5d7410=_0x2607,_0x31d9ad=this[_0x5d7410(0x10c)][_0x5d7410(0x12a)](![]);(_0x30d036=this[_0x5d7410(0xf4)])===null||_0x30d036===void 0x0?void 0x0:_0x30d036['log'](_0x5d7410(0xf1)+this[_0x5d7410(0xf0)]+_0x5d7410(0x11a)+this[_0x5d7410(0xdc)]+_0x5d7410(0xfd)+_0x31d9ad);const {id:_0x3e00c7}=yield bulk1_service_1['default']['createBatch'](this['instance'],_0x31d9ad,{'headers':{'Content-Type':this[_0x5d7410(0xf6)]}},this['jobId'],this[_0x5d7410(0xdf)]);this['baseBatchId']=_0x3e00c7;});}[_0x2e47c0(0x106)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3606d8=_0x2607,_0x31b7a6=yield bulk1_service_1[_0x3606d8(0xf2)][_0x3606d8(0x112)](this[_0x3606d8(0x11f)],{},this['jobId'],this[_0x3606d8(0xdf)]);this[_0x3606d8(0xf5)]=_0x31b7a6[_0x3606d8(0xf3)](({id:_0x299d48})=>_0x299d48!==this[_0x3606d8(0xfc)])[_0x3606d8(0xee)](({id:_0x3e1794,stateMessage:_0x48b57c,state:_0x2cc8be})=>({'id':_0x3e1794,'stateMessage':_0x48b57c,'state':_0x2cc8be})),this[_0x3606d8(0xdb)]=new Date()[_0x3606d8(0x114)]();});}[_0x2e47c0(0xef)](_0xb95d7e){const _0x11d329=_0x2e47c0;return bulk1_service_1[_0x11d329(0xf2)]['result'](this[_0x11d329(0x11f)],this[_0x11d329(0x129)],this[_0x11d329(0xdc)],this[_0x11d329(0x125)],_0xb95d7e,this[_0x11d329(0xdf)]);}[_0x2e47c0(0x109)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4b0f8c=_0x2607,{state:_0x3df41d,stateMessage:_0x13f89f}=yield bulk1_service_1['default'][_0x4b0f8c(0x118)](this[_0x4b0f8c(0x11f)],{},this[_0x4b0f8c(0xdc)],this[_0x4b0f8c(0xfc)],this[_0x4b0f8c(0xdf)]);switch(_0x3df41d){case bulk1_enums_1[_0x4b0f8c(0xfa)][_0x4b0f8c(0x100)]:case bulk1_enums_1[_0x4b0f8c(0xfa)]['InProgress']:!test_utils_1[_0x4b0f8c(0xf2)][_0x4b0f8c(0x123)]()&&(yield(0x0,promises_1[_0x4b0f8c(0x107)])(this[_0x4b0f8c(0x117)]));return this[_0x4b0f8c(0x109)]();case bulk1_enums_1[_0x4b0f8c(0xfa)][_0x4b0f8c(0x119)]:throw new salesforce_error_class_1[(_0x4b0f8c(0xf2))](_0x13f89f);}});}[_0x2e47c0(0xf7)](){var _0x27dacf;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x27e201=_0x2607,_0x3b136e=this[_0x27e201(0xf6)]===bulk1_enums_1[_0x27e201(0xd9)][_0x27e201(0x115)]?bulk1_enums_1[_0x27e201(0x108)][_0x27e201(0xd8)]:bulk1_enums_1[_0x27e201(0x108)]['XML'],_0xd5de4d={'object':this[_0x27e201(0xf0)],'contentType':_0x3b136e,'operation':this[_0x27e201(0xe3)]},_0x7456f1={'headers':{'Sforce-Enable-PKChunking':this['chunkSize']?'chunkSize='+this['chunkSize']:'TRUE'}},{id:_0x2c5e99}=yield bulk1_service_1[_0x27e201(0xf2)][_0x27e201(0xf7)](this[_0x27e201(0x11f)],_0xd5de4d,_0x7456f1,this[_0x27e201(0xdf)]);this[_0x27e201(0xdc)]=_0x2c5e99,(_0x27dacf=this[_0x27e201(0xf4)])===null||_0x27dacf===void 0x0?void 0x0:_0x27dacf[_0x27e201(0xe1)](_0x27e201(0xf1)+this[_0x27e201(0xf0)]+'\x20BulkJobId:\x20'+this[_0x27e201(0xdc)]+_0x27e201(0xea));});}}function _0x2607(_0x22fb0c,_0x52a7ce){const _0x33af8f=_0x33af();return _0x2607=function(_0x2607cf,_0x809117){_0x2607cf=_0x2607cf-0xd7;let _0x5d30e4=_0x33af8f[_0x2607cf];return _0x5d30e4;},_0x2607(_0x22fb0c,_0x52a7ce);}exports[_0x2e47c0(0xf2)]=Bulk1PkRetrieveData;